<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MCQ Test</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after {
      box-sizing: border-box;
    }
    body {
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(to right, #83a4d4, #b6fbff);
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
    }
    .container {
      background-color: white;
      padding: 30px 25px;
      margin-top: 50px;
      border-radius: 15px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.2);
      width: 100%;
      max-width: 600px;
    }
    h2 {
      text-align: center;
      color: #2c3e50;
    }
    #timer {
      text-align: center;
      font-size: 18px;
      font-weight: bold;
      color: #e74c3c;
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 10px;
      font-weight: bold;
      color: #34495e;
    }
    input[type="text"] {
      width: 100%;
      padding: 12px;
      margin-bottom: 20px;
      border: 2px solid #3498db;
      border-radius: 6px;
      font-size: 16px;
    }
    .question {
      margin-bottom: 20px;
    }
    .question p {
      margin-bottom: 10px;
      font-weight: bold;
      color: #2c3e50;
    }
    .question label {
      font-weight: normal;
      color: #333;
      display: block;
      margin-bottom: 5px;
      padding: 8px;
      border-radius: 5px;
      transition: background-color 0.3s ease;
    }
    .question input[type="radio"] {
      margin-right: 8px;
    }
    .question label:hover {
      color: #2980b9;
      cursor: pointer;
    }
    .selected {
      background-color: #d4edda;
    }
    button {
      width: 100%;
      background-color: #3498db;
      color: white;
      padding: 14px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #2980b9;
    }
    #statusMessage {
      margin-top: 20px;
      font-weight: bold;
      text-align: center;
    }
    .success {
      color: green;
    }
    .error {
      color: red;
    }
    @media (max-width: 600px) {
      .container {
        padding: 20px 15px;
        margin: 20px;
      }
      h2 {
        font-size: 22px;
      }
      input[type="text"],
      button {
        font-size: 15px;
      }
      .question p {
        font-size: 16px;
      }
    }
    #mcqForm button[type="submit"] {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>MCQ Test</h2>
    <div id="timer">Time Remaining: 60s</div>
    <form id="mcqForm">
      <label for="name">Your Name</label>
      <input type="text" name="name" id="name" placeholder="Enter your name" required />

      <label for="ein">EIN</label>
      <input type="text" name="ein" id="ein" placeholder="Enter EIN " pattern="\d+" required />

      <div id="questions-container"></div>
      <button type="submit">Submit</button>
    </form>
    <div id="statusMessage"></div>
  </div>

  <script>
    const form = document.getElementById('mcqForm');
    const statusEl = document.getElementById('statusMessage');
    const timerEl = document.getElementById('timer');
    const questionsContainer = document.getElementById('questions-container');

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    const questions = shuffle([
      { id: 'q1', question: 'Q1: What is 2 + 2?', options: ['3', '4', '5'] },
      { id: 'q2', question: 'Q2: What is the capital of France?', options: ['Paris', 'London', 'Rome'] },
      { id: 'q3', question: 'Q3: What color is the sky?', options: ['Blue', 'Green', 'Red'] },
      { id: 'q4', question: 'Q4: How many continents are there?', options: ['5', '6', '7'] },
      { id: 'q5', question: 'Q5: Which planet is known as the Red Planet?', options: ['Mars', 'Venus', 'Jupiter'] },
      { id: 'q6', question: 'Q6: What is the boiling point of water?', options: ['100°C', '90°C', '80°C'] },
      { id: 'q7', question: 'Q7: Who wrote "Romeo and Juliet"?', options: ['Shakespeare', 'Tolstoy', 'Hemingway'] },
      { id: 'q8', question: 'Q8: What is the largest mammal?', options: ['Elephant', 'Blue Whale', 'Giraffe'] },
      { id: 'q9', question: 'Q9: What is H2O?', options: ['Oxygen', 'Water', 'Hydrogen'] },
      { id: 'q10', question: 'Q10: What gas do plants absorb?', options: ['Oxygen', 'Nitrogen', 'Carbon Dioxide'] }
    ]);

    let currentQuestionIndex = 0;
    const userAnswers = {};

    const nextBtn = document.createElement('button');
    nextBtn.textContent = 'Next';
    nextBtn.type = 'button';
    nextBtn.style.marginTop = '15px';

    function renderQuestion(index) {
      questionsContainer.innerHTML = '';
      const q = questions[index];
      const shuffledOptions = shuffle([...q.options]);

      const questionHTML = `
        <div class="question" id="${q.id}-container">
          <p>${q.question}</p>
          ${shuffledOptions.map(opt => `
            <label>
              <input type="radio" name="${q.id}" value="${opt}" ${userAnswers[q.id] === opt ? 'checked' : ''} required />
              ${opt}
            </label>
          `).join('')}
        </div>
      `;
      questionsContainer.innerHTML = questionHTML;
      questionsContainer.appendChild(nextBtn);

      const radios = document.querySelectorAll(`input[name="${q.id}"]`);
      radios.forEach(radio => {
        radio.addEventListener('change', () => {
          document.querySelectorAll(`input[name="${q.id}"]`).forEach(r => {
            r.closest('label').classList.remove('selected');
          });
          if (radio.checked) {
            radio.closest('label').classList.add('selected');
          }
        });
      });
    }

    nextBtn.addEventListener('click', () => {
      const q = questions[currentQuestionIndex];
      const selectedOption = document.querySelector(`input[name="${q.id}"]:checked`);
      if (!selectedOption) {
        alert('Please select an option to proceed.');
        return;
      }
      userAnswers[q.id] = selectedOption.value;
      currentQuestionIndex++;
      if (currentQuestionIndex < questions.length) {
        renderQuestion(currentQuestionIndex);
      } else {
        submitForm();
      }
    });

    renderQuestion(currentQuestionIndex);

    function submitForm() {
      clearInterval(timerInterval);
      const name = document.getElementById('name').value.trim();
      const ein = document.getElementById('ein').value.trim();
      if (!name || !ein) {
        statusEl.textContent = '❌ Please enter your name and EIN.';
        statusEl.className = 'error';
        return;
      }

      const data = { name, ein };
      questions.forEach(q => {
        data[q.id] = userAnswers[q.id] || '';
      });

      const incomplete = Object.keys(userAnswers).length < questions.length;
      statusEl.textContent = 'Submitting...';

      fetch('https://script.google.com/macros/s/AKfycbwZOH1eMCF73z0BlA1UMjBLjPXsHRcYnK7wzx17X_3e4-n-t5dZh_KMPMiZUDGJSiuaxQ/exec', {
        method: 'POST',
        headers: { 'Content-Type': 'text/plain;charset=utf-8' },
        body: JSON.stringify(data)
      })
      .then(res => res.text())
      .then(response => {
        statusEl.textContent = incomplete
          ? '⏱ Form submitted with some unanswered questions.'
          : '✅ Form submitted successfully!';
        statusEl.className = incomplete ? 'error' : 'success';
        form.reset();
        questionsContainer.innerHTML = '';
        timerEl.textContent = '';
      })
      .catch(err => {
        statusEl.textContent = '❌ Error: ' + err.message;
        statusEl.className = 'error';
        console.error(err);
      });
    }

    let timeLeft = 60;
    const timerInterval = setInterval(() => {
      timeLeft--;
      timerEl.textContent = `Time Remaining: ${timeLeft}s`;
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        submitForm();
      }
    }, 1000);

    form.addEventListener('submit', function (e) {
      e.preventDefault();
      submitForm();
    });
  </script>
</body>
</html>
