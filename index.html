<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MCQ Test</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; }
    body { font-family: 'Roboto', sans-serif; background: linear-gradient(to right, #83a4d4, #b6fbff); margin:0; padding:0; display:flex; justify-content:center; align-items:flex-start; min-height:100vh; }
    .container { background-color:white; padding:30px 25px; margin-top:50px; border-radius:15px; box-shadow:0 8px 16px rgba(0,0,0,0.2); width:100%; max-width:600px; }
    h2 { text-align:center; color:#2c3e50; }
    #timer { text-align:center; font-size:18px; font-weight:bold; color:#e74c3c; margin-bottom:15px; }
    label { display:block; margin-bottom:10px; font-weight:bold; color:#34495e; }
    input[type="text"] { width:100%; padding:12px; margin-bottom:20px; border:2px solid #3498db; border-radius:6px; font-size:16px; }
    .question { margin-bottom:20px; }
    .question p { margin-bottom:10px; font-weight:bold; color:#2c3e50; }
    .question label { font-weight:normal; color:#333; display:block; margin-bottom:5px; padding:8px; border-radius:5px; transition:background-color 0.3s ease; }
    .question input[type="radio"] { margin-right:8px; }
    .question label:hover { color:#2980b9; cursor:pointer; }
    .selected { background-color:#d4edda; }
    button { width:100%; background-color:#3498db; color:white; padding:14px; font-size:16px; border:none; border-radius:8px; cursor:pointer; transition:background-color 0.3s ease; }
    button:hover { background-color:#2980b9; }
    #statusMessage { margin-top:20px; font-weight:bold; text-align:center; }
    .success { color:green; }
    .error { color:red; }
    @media (max-width:600px) {
      .container { padding:20px 15px; margin:20px; }
      h2 { font-size:22px; }
      input[type="text"], button { font-size:15px; }
      .question p { font-size:16px; }
    }
    #mcqForm button[type="submit"] { display:none; }
  </style>
</head>
<body>
  <div class="container">
    <h2>MCQ Test</h2>
    <div id="timer">Time Remaining: 25:00</div>
    <form id="mcqForm">
      <label for="name">Your Name</label>
      <input type="text" name="name" id="name" placeholder="Enter your name" required />

      <label for="ein">EIN</label>
      <input type="text" name="ein" id="ein" placeholder="Enter EIN " pattern="\d+" required />

      <div id="questions-container"></div>
      <button type="submit">Submit</button>
    </form>
    <div id="statusMessage"></div>
  </div>

<script>
  const form = document.getElementById('mcqForm');
  const statusEl = document.getElementById('statusMessage');
  const timerEl = document.getElementById('timer');
  const questionsContainer = document.getElementById('questions-container');

  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  // Questions with answer key
  const questions = shuffle([
    { id: 'q1', question: '1. What should be checked if a customer\'s Debit card transaction fails due to insufficient funds?', options: ['Bad PIN, IRIS', 'Expired Card, IRIS', 'Device Issue', 'Amount Locked or account Balance, T-24'], answer: 'Amount Locked or account Balance, T-24' },
    { id: 'q2', question: '2. What is indicated when a transaction is declined with the reason \'Bad PIN\'?', options: ['Session expired', 'Incorrect PIN entered', 'Account blocked', 'Expired card'], answer: 'Incorrect PIN entered' },
    { id: 'q3', question: '3. What does a WARM card status indicate?', options: ['Blocked permanently', 'International access enabled', 'Temporarily Blocked', 'Verified card'], answer: 'Temporarily Blocked' },
    { id: 'q4', question: '4. Which tool is used to check if an ECOMM session is active?', options: ['Admin Portal', 'Locked Amount Enquiry HM', 'T24', 'IRIS'], answer: 'IRIS' },
    { id: 'q5', question: '5. If the ECOMM session has never been activated, what will be observed by ACC agent?', options: ['Error message', 'Card expired message', 'Blank transaction history', 'Device error'], answer: 'Blank transaction history' },
    { id: 'q6', question: '6. What is a common reason for fund transfer failure after password reset?', options: ['Card not delivered', 'Transfer limit not assigned', 'Device blocked', 'Wrong CP status'], answer: 'Transfer limit not assigned' },
    { id: 'q7', question: '7. Which flag must be enabled after the Bio Metric from Branch for the myABL Registration?', options: ['BMS Flag', 'OTP Flag', 'Device Binding Flag', 'CP Flag'], answer: 'BMS Flag' },
    { id: 'q8', question: '8. Why would a customer receive a \'Provided information is incorrect\' message while registering?', options: ['Mobile Number Missing', 'Account Status Not Active', 'Already registered on myABL', 'All'], answer: 'All' },
    { id: 'q9', question: '9. Which mobile number format is valid for WhatsApp Banking registration?', options: ['00092XXXXXXXXX', '03XXXXXXXXX', '+923XXXXXXXXX', '923XXXXXXXXX'], answer: '03XXXXXXXXX' },
    { id: 'q10', question: '10. Why can\'t users with ID Type – B register for WhatsApp Banking/myABL?', options: ['Device limit exceeded', 'ID type not allowed', 'Invalid email', 'Blocked SIM'], answer: 'ID type not allowed' },
    { id: 'q11', question: '11. What is the maximum amount that can be sent to a Microfinance Bank in single transaction?', options: ['20,000 PKR', '25,000 PKR', '10,000 PKR', '15,000 PKR'], answer: '25,000 PKR' },
    { id: 'q12', question: '12. How many users can log in from the same PC on web?', options: ['5', '10', 'Unlimited', '15'], answer: '15' },
    { id: 'q13', question: '13. What is the device registration limit for a single user on myABL?', options: ['3 devices', '5 devices', 'Unlimited', '10 devices'], answer: '5 devices' },
    { id: 'q14', question: '14. Which account type is not eligible for RAAST transfers via Mobile?', options: ['Running Finance Account', 'Joint Account', 'Saving Account', 'Current Account'], answer: 'Running Finance Account' },
    { id: 'q15', question: '15. For virtual Card creation customer must have\'?', options: ['Debit Card', 'Credit Card', 'Virtual Card', 'PayPak Card'], answer: 'Credit Card' },
    { id: 'q16', question: '16. What is the requirement for registering WhatsApp Banking registration?', options: ['Email verification', 'Valid mobile number in correct format', 'ATM PIN reset', 'NADRA verification'], answer: 'Valid mobile number in correct format' },
    { id: 'q17', question: '17. Which card status indicates it is temporarily blocked and can be reactivated with customer consent?', options: ['Fresh', 'EXPIRED', 'HOT', 'WARM'], answer: 'WARM' },
    { id: 'q18', question: '18. Which field should be checked if a card transaction fails with \'Transaction source not allowed\'?', options: ['Intern Channel Blocking', 'BMS Flag', 'CP View', 'Account Status'], answer: 'Intern Channel Blocking' },
    { id: 'q19', question: '19. What message is likely to appear when a customer attempts RAAST P2P transfer without a proper limit package?', options: ['OTP mismatch', 'Transaction limit reached', 'Service temporarily unavailable', 'Limit not found'], answer: 'Limit not found' },
    { id: 'q20', question: '20. Which of the following must be updated in T-24 for OTP via email to work correctly?', options: ['Mobile number', 'CP Flag', 'Email address', 'Fingerprint'], answer: 'Email address' },
    { id: 'q21', question: '21. When does a card typically show \'Remaining Frequency Exceeded\' error?', options: ['Expired card', 'Unverified mobile number', 'Exceeded withdrawal attempts', 'Limit package mismatch'], answer: 'Exceeded withdrawal attempts' },
    { id: 'q22', question: '22. How many users can login on the same device?', options: ['2', 'Unlimited', '5', '3'], answer: '2' },
    { id: 'q23', question: '23. Which field in T-24 shows if the CP is verified?', options: ['Intern Channel Blocking', 'Email Tab', 'Manual Transactions', 'Account Status'], answer: 'Account Status' },
    { id: 'q24', question: '24. What happens if the customer Bio Metric Fails during Login/Registration?', options: ['User is locked', 'Device binding fails', 'Session expires', 'App auto-resets'], answer: 'Device binding fails' },
    { id: 'q25', question: '25. Is the customer able to create the Virtual Card if his physical card is in HOT state?', options: ['Yes', 'No'], answer: 'Yes' }
  ]);

  let currentQuestionIndex = 0;
  const userAnswers = {};
  const nextBtn = document.createElement('button');
  nextBtn.textContent = 'Next';
  nextBtn.type = 'button';
  nextBtn.style.marginTop = '15px';

  function renderQuestion(index) {
    questionsContainer.innerHTML = '';
    const q = questions[index];
    const shuffledOptions = shuffle([...q.options]);

    const questionHTML = `
      <div class="question" id="${q.id}-container">
        <p>${q.question}</p>
        ${shuffledOptions.map(opt => `
          <label>
            <input type="radio" name="${q.id}" value="${opt}" ${userAnswers[q.id] === opt ? 'checked' : ''} required />
            ${opt}
          </label>
        `).join('')}
      </div>
    `;
    questionsContainer.innerHTML = questionHTML;
    questionsContainer.appendChild(nextBtn);

    const radios = document.querySelectorAll(`input[name="${q.id}"]`);
    radios.forEach(radio => {
      radio.addEventListener('change', () => {
        document.querySelectorAll(`input[name="${q.id}"]`).forEach(r => r.closest('label').classList.remove('selected'));
        if (radio.checked) radio.closest('label').classList.add('selected');
      });
    });
  }

  nextBtn.addEventListener('click', () => {
    const q = questions[currentQuestionIndex];
    const selectedOption = document.querySelector(`input[name="${q.id}"]:checked`);
    if (!selectedOption) { alert('Please select an option to proceed.'); return; }
    userAnswers[q.id] = selectedOption.value;
    currentQuestionIndex++;
    if (currentQuestionIndex < questions.length) renderQuestion(currentQuestionIndex);
    else submitForm();
  });

  renderQuestion(currentQuestionIndex);

  function submitForm() {
    clearInterval(timerInterval);
    const name = document.getElementById('name').value.trim();
    const ein = document.getElementById('ein').value.trim();
    if (!name || !ein) { statusEl.textContent = '❌ Please enter your name and EIN.'; statusEl.className = 'error'; return; }

    let correctCount = 0;
    questions.forEach(q => {
      if (userAnswers[q.id] === q.answer) correctCount++;
    });
    const totalScore = correctCount * 5;

    const data = { name, ein, score: totalScore };
    questions.forEach(q => { data[q.id] = userAnswers[q.id] || ''; });

    statusEl.textContent = 'Submitting...';

    fetch('https://script.google.com/macros/s/AKfycbyJb92AXnnvflZuBvxGB67z_FzmTPz8-tUK2AIp4ZXFu3IWADuhb1VdltzpllM9uhNz-w/exec', {
      method: 'POST',
      headers: { 'Content-Type': 'text/plain;charset=utf-8' },
      body: JSON.stringify(data)
    })
    .then(res => res.text())
    .then(response => {
      statusEl.textContent = '✅ Form submitted successfully!';
      statusEl.className = 'success';
      form.reset();
      questionsContainer.innerHTML = '';
      timerEl.textContent = '';
    })
    .catch(err => {
      statusEl.textContent = '❌ Error: ' + err.message;
      statusEl.className = 'error';
      console.error(err);
    });
  }

  // Timer in MM:SS format
  let timeLeft = 1500; // 25 minutes
  function formatTime(seconds) {
    const mins = Math.floor(seconds / 60);
    const secs = seconds % 60;
    return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
  }

  const timerInterval = setInterval(() => {
    timerEl.textContent = `Time Remaining: ${formatTime(timeLeft)}`;
    timeLeft--;
    if (timeLeft < 0) { clearInterval(timerInterval); submitForm(); }
  }, 1000);

  form.addEventListener('submit', e => { e.preventDefault(); submitForm(); });
</script>
</body>
</html>
